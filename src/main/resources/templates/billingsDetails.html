<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
  <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
</head>
<body>
<nav th:replace="/fragments/nav :: nav(user = ${user})"></nav>
<div style="margin-top:80px;">
<div class="jumbotron" >
  <input hidden th:field="*{listType}"/>
  <form method = "GET" th:action = "@{'/billings/details/' + __${billingDetailsForm.eventId}__} ">
  <select name="type" >
    <option value="available">Available</option>
    <option value="deleted">Deleted</option>
    <option value="all">Available + Deleted</option>
  </select>
    <button type="submit" class="btn btn-warning">Filter</button>

  </form>

  <form action="#" th:action="@{save}" th:object="${billingDetailsForm}" method="post">

    <input hidden th:field="*{eventId}"/>
    <h3>Billings for Event </h3>

    <table class="table">
      <thead>
      <tr>
        <th>
          <label> Title </label>
        </th>
        <th>
          <label> Type </label>
        </th>
        <th>
          <label> Date of creation </label>
        </th>
        <th>
          <label> Money </label>
        </th>
        <th>
          <label> Date of Edition </label>
        </th>
        <th>
          <label> is confirmed? </label>
        </th>
        <th>
          <label> Date of confirm </label>
        </th>
        <th>
          <label> Person assign to </label>
        </th>
        <th>Delete</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="billing, itemStat : ${billingDetailsForm.billingForms}">
        <input hidden th:field="*{billingForms[__${itemStat.index}__].id}"/>

        <td>
          <input class="form-control" type="text"
                 th:id="${'billing' + itemStat.index}"
                 th:field="*{billingForms[__${itemStat.index}__].title}">
        </td>
        <td>
          <select name="state"  th:field="*{billingForms[__${itemStat.index}__].billingType}" >
            <option th:each="state : ${T(com.example.event_manager.model.BillingType).values()}"
                    th:value="${state}" th:text="${state}"></option>
          </select>
        </td>
        <td>
          <input class="form-control" type="datetime-local"
                 th:field="*{billingForms[__${itemStat.index}__].dateOfCreation}"/>
        </td>
        <td>
          <input class="form-control" type="number" step="0.01"
                 th:field="*{billingForms[__${itemStat.index}__].money}">
        </td>
        <td>
          <input class="form-control" type="datetime-local"
                 th:field="*{billingForms[__${itemStat.index}__].dateOfEdition}"/>
        </td>
        <td>
          <div class="form-check">
            <input class="form-check-input" type="radio" th:field= "*{billingForms[__${itemStat.index}__].confirmed}" name="confirmedTrue" id="confirmedTrueList" value="1" checked>
            <label class="form-check-label" for="exampleRadios1">
              Yes
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" th:field= "*{billingForms[__${itemStat.index}__].confirmed}" name="confirmedFalse" id="confirmedFalseList" value="0">
            <label class="form-check-label" for="exampleRadios2">
              No
            </label>
          </div>
        </td>
        <td>
          <input class="form-control" type="datetime-local"
                 th:field="*{billingForms[__${itemStat.index}__].dateOfConfirm}"/>
        </td>
        <td>
          <select class="form-control"
                  th:field="*{billingForms[__${itemStat.index}__].personAssigned}">
            <option th:each="person : ${billingDetailsForm.people}"
                    th:text="${person.name}"
                    th:value="${person.id}"></option>
          </select>
        </td>
        <td>
        <div th:if="not *{billingForms[__${itemStat.index}__].deleted}">
          <a class="btn btn-danger" href="#"
               th:href="@{/billings/details/delete?billingId=} + *{billingForms[__${itemStat.index}__].id} + '&eventId=' + *{eventId}"
            ><i class="fa fa-trash-o" aria-hidden="false"></i></a>
        </div>
        </td>

<!--        <td>-->
<!--        </td>-->
      </tr>
      </tbody>
    </table>
    <div th:if=" ${listType} == 'available' ">
      <button style="width: 150px !important;" nid="button_add_billing"
              class="btn btn-primary" name="action" value="addBilling"> Add new
        element
      </button>
    </div>
    <div th:if=" ${listType} == 'available' ">
    <button style="width: 150px !important;" name="action" type="submit" class="btn btn-success">Save changes</button>
    </div>
  </form>

</div>
<div class="jumbotron">
  <form action="#" th:action="@{/billings/details/report/filter?type=} + ${listType}" th:object="${billingFilter}" method="post">
    <h3>Report in XLSX </h3>
    <table class="table">
      <input hidden th:field="*{eventId}"/>
      <thead>
    <tr>
      <th scope="col">Type</th>
      <th scope="col">Creation Date</th>
      <th scope="col">Is confirmed?</th>
      <th scope="col">Person assigned</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td>
      <div class="form-check">
        <input class="form-check-input" th:field= "*{billingType}" type="radio" name="exampleRadios" id="exampleRadios1" value="all" checked>
        <label class="form-check-label" for="exampleRadios1">
        All
        </label>
      </div>
      <div class="form-check">
        <input class="form-check-input" th:field= "*{billingType}" type="radio" name="exampleRadios" id="exampleRadios2" value="INCOME">
        <label class="form-check-label" for="exampleRadios2">
          INCOME
        </label>
      </div>
      <div class="form-check">
        <input class="form-check-input" th:field= "*{billingType}" type="radio" name="exampleRadios" id="exampleRadios3" value="OUTGO">
        <label class="form-check-label" for="exampleRadios3">
          OUTGO
        </label>
      </div>
      </td>
      <td>
        <table class="table" >
          <tbody>
            <tr width="30px">
              <td width="30px">
                <label>Start</label>
                <input type="datetime-local" th:value="*{dateCreationStart}" th:field="*{dateCreationStart}" id="dateCreationStart"/>
              </td>
            </tr>
            <tr width="30px">
              <td width="30px">
                <label>End</label>
                <input type="datetime-local" th:value="*{dateCreationEnd}" th:field="*{dateCreationEnd}" id="dateCreationEnd"/>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    <td>
    <div class="form-check">
      <input class="form-check-input" type="radio" th:field= "*{confirmed}" name="confirmedTrue" id="confirmedTrue" value="1" checked>
      <label class="form-check-label" for="exampleRadios1">
        Yes
      </label>
    </div>
    <div class="form-check">
      <input class="form-check-input" type="radio" th:field= "*{confirmed}" name="confirmedFalse" id="confirmedFalse" value="0">
      <label class="form-check-label" for="exampleRadios2">
        No
      </label>
    </div>
    </td>
      <td>
        <div class="form-group blu-margin">
          <select class="form-control" id="dropOperator" th:field="*{personName}" >
            <option value="0">select person</option>
            <option th:each="person : ${billingDetailsForm.people}" th:value="${person.name}" th:text="${person.name}"></option>
          </select>
        </div>
      </td>
  <td>
    <button name="action" type="submit" class="btn btn-success">Generate filtered report</button>
  </td>
    </tr>
    </tbody>
  </table>
  </form>
  <form th:object= "${billingDetailsForm}" method="get">
    <a class="btn btn-primary" href="#"
       th:href="@{/billings/details/report/all?eventId=} + *{eventId} + '&type=' + ${listType}"
    >Generate report for all billings</a>
  </form>
</div>
</div>
</body>
</html>



